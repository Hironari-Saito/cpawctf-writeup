# Q29.[Crypto] Common World
Cpaw君は,以下の公開鍵を用いて暗号化された暗号文Cを受け取りました．しかしCpaw君は秘密鍵を忘れてしまいました.Cpaw君のために暗号文を解読してあげましょう.

(e, N) = (11, 236934049743116267137999082243372631809789567482083918717832642810097363305512293474568071369055296264199854438630820352634325357252399203160052660683745421710174826323192475870497319105418435646820494864987787286941817224659073497212768480618387152477878449603008187097148599534206055318807657902493850180695091646575878916531742076951110529004783428260456713315007812112632429296257313525506207087475539303737022587194108436132757979273391594299137176227924904126161234005321583720836733205639052615538054399452669637400105028428545751844036229657412844469034970807562336527158965779903175305550570647732255961850364080642984562893392375273054434538280546913977098212083374336482279710348958536764229803743404325258229707314844255917497531735251105389366176228741806064378293682890877558325834873371615135474627913981994123692172918524625407966731238257519603614744577)

暗号文: 80265690974140286785447882525076768851800986505783169077080797677035805215248640465159446426193422263912423067392651719120282968933314718780685629466284745121303594495759721471318134122366715904


## Solution
Nが素因数分解できるか[factordb](http://factordb.com/)で確認する。
解が`N = (2^2281-1)*(2^607-1)`と1つだけであった。

### p = 2^2281 - 1
446087557183758429571151706402101809886208632412859901111991219963404685792820473369112545269003989026153245931124316702395758705693679364790903497461147071065254193353938124978226307947312410798874869040070279328428810311754844108094878252494866760969586998128982645877596028979171536962503068429617331702184750324583009171832104916050157628886606372145501702225925125224076829605427173573964812995250569412480720738476855293681666712844831190877620606786663862190240118570736831901886479225810414714078935386562497968178729127629594924411960961386713946279899275006954917139758796061223803393537381034666494402951052059047968693255388647930440925104186817009640171764133172418132836351
### q = 2^607 - 1
531137992816767098689588206552468627329593117727031923199444138200403559860852242739162502265229285668889329486246501015346579337652707239409519978766587351943831270835393219031728127


###　　秘密鍵を求める
Φ = lcm(p-1, q-1)
d = e^-1 mod Φ

上記を算出するプログラムを書く


## Another Solution

### Low Public Exponent Attack
eが小さいときに、nのe乗根以下の平文mを単純にcのe乗根を取れば平文を求めることができる。
```
暗号文c ≡ m^e mod nで与えられていてm < n^(1/e)を満たす場合、mod nの影響を受けないのでm = c^(1/e)でmがもとまる。
```

### Common Modulus Attack
同一の平文mを異なるeで暗号化した暗号文cの組がある場合、拡張ユークリッド互除法を用いて平文mを復号できる。

```
RSA公開鍵(n,e1), (n,e2)と平文m、それぞれの公開鍵で暗号化した暗号文c1,c2があり、gcd(e1,e2)=1の時、n,e1,e2,c1,c2から平文mを導出することができる。
```

ヒントに記載されている情報と問題の情報を利用する。
e1 = 11かつe2が13であることから`gcd(e1,e2)=1`を満たす。


## Answer
cpaw{424311244315114354}


